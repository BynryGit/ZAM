<!DOCTYPE html>
<html>
{% load staticfiles %}
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Page title -->
    {% if request.session.user_role != 'Customer' %}
        <title>ZAM | Change Password</title>
    {% else %}
        <title>YfinAdvisor | Change Password</title>
    {% endif %}
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <!--<link rel="shortcut icon" type="image/ico" href="favicon.ico" />-->

    <!-- Vendor styles -->


    <link rel="stylesheet" href="{% static 'vendor/fontawesome/css/font-awesome.css' %}"/>
    <link rel="stylesheet" href="{% static 'vendor/metisMenu/dist/metisMenu.css' %}"/>
    <link rel="stylesheet" href="{% static 'vendor/animate.css/animate.css' %}"/>
    <link rel="stylesheet" href="{% static 'vendor/bootstrap/dist/css/bootstrap.css' %}"/>
    <link rel="stylesheet"
          href="{% static 'vendor/datatables_plugins/integration/bootstrap/3/dataTables.bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'vendor/sweetalert/lib/sweet-alert.css' %}"/>

    <!-- App styles -->
    <link rel="stylesheet" href="{% static 'fonts/pe-icon-7-stroke/css/pe-icon-7-stroke.css' %}"/>
    <link rel="stylesheet" href="{% static 'fonts/pe-icon-7-stroke/css/helper.css' %}"/>
    <link rel="stylesheet" href="{% static 'styles/style.css' %}"/>
    <link rel="stylesheet" href="{% static 'vendor/select2-3.5.2/select2.css' %}"/>
    <link rel="stylesheet" href="{% static 'vendor/select2-bootstrap/select2-bootstrap.css' %}"/>

    <style type="text/css">

        .page-header {
            margin-top: 1%;
        }

        .bac-but {
            margin-bottom: 2px;
            text-align: right;
        }

        .btn-success.btn-outline:hover {
            background-color: #62cb31;
        }

        .btn-success.btn-outline:hover {
            background-color: #62cb31;
        }

        .baccol {
            background-color: #0A37B8;
        }

        .font-col {
            color: #FFFFFF;

        }

        #side-menu li.active a {
            background-color: #7160A9 !important;
            color: #fff;

        }

        #side-menu li:hover a {
            background-color: #7160A9 !important;
            color: #fff;

        }

        .btn-primary2:hover {

            background-color: #7160A9 !important;
            border-color: #7160A9 !important;
            color: #FFFFFF
        }

        .btn-primary2.btn-outline:hover {
            color: #6a6c6f;
        !important;
            color: #FFFFFF;

        }

        .btn-primary2.btn-outline {
            color: #6a6c6f;
        !important;
        }

        .btn-primary2 {
            border-color: #7160A9 !important;
        }

        .bac-clr {
            background: linear-gradient(to left, #fff -20%, #7160A9 40%) repeat scroll 0% 0% !important;
            border: 1px solid #E4E5E7;
            border-radius: 2px;
            padding: 20px;
            position: relative;
        }

        #side-menu li .nav-second-level li a {
            color: #FFFFFF;
        }

        .hpanel.hblue .panel-body {
            border-top: 2px solid #7160A9;
        }

        .label-success {
            background-color: #7160A9;
        }

        .small-logo {
            display: none;
            text-align: center;
            padding-top: 6px;
            font-size: 28px;
            font-weight: 800;
            float: left;
            display: block;
            color: #7160A9;
        }

        .text-primary {
            color: #7160A9;
        }
    </style>

</head>
<body>

<!-- Simple splash screen-->

<div class="splash">
    <div class="splash-title"><img src="{% static 'images/loading-bars.gif' %}" width="64" height="64"/></div>
</div>

<!--[if lt IE 7]>
<p class="alert alert-danger">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->

<!-- Header -->
<div id="header">

    <!-- <div id="logo" class="light-version">
        <span>
           ZAM
        </span>
    </div> -->
    <nav role="navigation">
        <div class="header-link hide-menu"><i class="fa fa-bars"></i></div>
        {% if request.session.user_role == 'Customer' %}
            <div class="small-logo" style="padding-top: 0px">
               <img src="{% static 'images/zam-logo-1.png' %}" style="width: 130px" class="img-circle m-b" alt="logo"></img>
        		</div>
        {% else %}
            <div class="small-logo">
                <span class="text-primary">Zeus Asset Management</span>
            </div>
        {% endif %}

        <div class="navbar-right">
            <ul class="nav navbar-nav no-borders">
                <li class="dropdown">

                    <ul class="dropdown-menu hdropdown notification animated flipInX">
                        <li>
                            <a>
                                <span class="label label-success">NEW</span> It is a long established.
                            </a>
                        </li>
                        <li>
                            <a>
                                <span class="label label-warning">WAR</span> There are many variations.
                            </a>
                        </li>
                        <li>
                            <a>
                                <span class="label label-danger">ERR</span> Contrary to popular belief.
                            </a>
                        </li>
                        <li class="summary"><a href="#">See all notifications</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle label-menu-corner" href="#" data-toggle="dropdown">
                        <i class="pe-7s-mail"></i>
                        {% if request.session.user_role == 'Marketing Manager' %}
                        <span class="label label-success">{{total_count}}</span>
                        {% endif %}
                    </a>
                    {% if request.session.user_role == 'Marketing Manager' %}
                    <ul class="dropdown-menu hdropdown animated flipInX">
                        <div class="title">
                            You have {{total_count}} new messages
                        </div>
                        <li>
                            <a href="/open-discussion-forum/">
                                Question ({{question_count}})
                            </a>
                        </li>
                        <li>
                            <a href="/open-discussion-forum/">
                                Response ({{response_count}})
                            </a>
                        </li>
                        <li>
                            <a href="/open-discussion-forum/">
                                Reply ({{responseto_count}})
                            </a>
                        </li>
                        <li class="summary"><a href="/open-discussion-forum/">See All Messages</a></li>
                    </ul>
                    {% endif %}
                </li>
                <li class="dropdown">
                    <a href="/signing-out/">
                        <i class="pe-7s-upload pe-rotate-90"></i>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</div>

<!-- Navigation -->
<aside id="menu">
    <div id="navigation">
        <div class="profile-picture">
            <div>
                <img src="{% static 'images/images.png' %}" class="img-circle m-b" alt="logo">
            </div>

            <div class="stats-label text-color">
                <span class="font-extra-bold">{{ request.session.full_name }}</span><br>
                <small class="text-muted">{{ request.session.user_role }}</small>

            </div>
        </div>

        <ul class="nav" id="side-menu">
            {% if request.session.user_role == 'Portfolio Manager' or request.session.user_role == 'Super Admin' or request.session.user_role == 'Marketing Manager' %}
                <li>
                    <a href="/crm-index/"> <span class="nav-label">Client Relationship Management</span></a>
                </li>
            {% endif %}
            {% if request.session.user_role == 'Portfolio Manager' or request.session.user_role == 'Super Admin' or request.session.user_role == 'Analyst' %}
            <li><a href="/open-research-page/?tab_id=1">Research</a></li>
            {% endif %}
            {% if request.session.user_role == 'Customer' %}
                <li>
                    <a href="/customer/"> <span class="nav-label">My Planning Tool</span></a>
                </li>
                <li>
               	 <a href="/customer/customer-details/"> <span class="nav-label">Personal Information</span></a>
            	 </li>
            {% endif %}
                <li ><a href="/open-discussion-forum/">Discussion Forum</a></li>
              {% if request.session.user_role == 'Portfolio Manager' or request.session.user_role == 'Super Admin' or request.session.user_role == 'Analyst' %}
                <li class="treeview">
                <a href="#"><span class="nav-label">Security Data Management</span><span class="fa arrow"></span> </a>
                <ul class="nav nav-second-level">
                    <li><a href="/open-security-page/">Security</a></li>
                    <li><a href="/open-security-price-page/">Price</a></li>
                </ul>
            </li>
            {% endif %}
	        {% if request.session.user_role == 'Portfolio Manager' or request.session.user_role == 'Super Admin' %}
	           <li>
	                    <a href="/open-trade/"> <span class="nav-label">Trade</span></a>
	                </li>
	                <li>
	                    <a href="/open-position/"> <span class="nav-label">Position</span></a>
	                </li>
	        {% endif %}
            {% if request.session.user_role != 'Customer' %}
                <li>
                    <a href="/index/"> <span class="nav-label">Dashboard</span></a>
                </li>
            {% endif %}
            {% if request.session.user_role == 'Super Admin' %}
            <li class="treeview"><a href="#"><span class="nav-label">Planning Tool</span><span class="fa arrow"></span>
            </a>
                <ul class="nav nav-second-level">
                    <li><a href="/open-YFinAdvisor-index/">Planning Tool Input</a></li>
                    <li><a href="/open-YFinAdvisor-customer/">Customer</a></li>
                </ul>
            </li>
            {% endif %} {% if request.session.user_role == 'Super Admin' or request.session.user_role == 'Admin' %}
            <li><a href="/open-user-index/"> <span class="nav-label">User Management</span></a></li>
            {% endif %}
            {% if request.session.user_role != 'Customer' %}
                <li class="active">
                    <a href="/open-rename-password/"> <span class="nav-label">Change Password</span></a>
                </li>
            {% else %}

                <li class="active">
                    <a href="/customer/change-password/"> <span class="nav-label">Change Password</span></a>
                </li>
            {% endif %}
        </ul>
    </div>
</aside>

<!-- Main Wrapper -->
<div id="wrapper">

    <div class="normalheader transition animated fadeIn">
        <div class="hpanel">
            <div class="bac-clr">
                <h3 style="display:inline;" class="font-light m-b-xs font-col">
                    Change Password
                </h3>
            </div>
        </div>
    </div>


    <div class="login-container animate-panel">
        <div class="row">
            <div class="col-md-12">
                <div class="hpanel hblue">
                    <div class="panel-body">
                        <form id="change_pwd_form">
                            {% csrf_token %}
                            <div class="form-group">
                                <P id="error_msg"></P>
                            </div>
                            <label id="lbl_success_msg" style="color:green"></label>
                            <label id="lbl_error_msg" style="color:red"></label>

                                <div class="form-group">
                                <label class="control-label" for="password">Current Password*</label><label
                                    id="lbl_old_password" style="color:white">&nbsp Fill out Current Password</label>
                                <input type="password" title="Please enter your password"
                                       required=""
                                       value="" name="old_password" id="old_password" data-match="#password"
                                       data-match-error="Whoops, these don't match" class="form-control"/>

                                <div class="help-block with-errors"></div>
                                </div>



                                    <div class="form-group">
                                        <label class="control-label" for="password"> New Password*</label><label
                                            id="lbl_password"
                                            style="color:white">&nbsp
                                        Fill out New Password</label>
                                        <input type="password" data-toggle="validator" data-minlength="8"
                                               data-maxlength="15"
                                               title="Please enter your password" required=""
                                               value=""
                                               name="password" id="password" class="form-control"/>

                                        <div id="pwd_policy">
                            <span class="help-block" id="strength" style="color:red">
                                &nbsp &nbsp * The password should be 8-15 characters with 1 upper case  <br>
                                &nbsp &nbsp &nbsp &nbsp letter, 1 number and 1 special character.
                            </span>
                                        </div>
                                    </div>


                                <div class="form-group">
                                <label class="control-label" for="password">Confirm Password</label><label
                                    id="lbl_confirm_password" style="color:white">&nbsp Fill out Confirm Password</label>
                                <input type="password" title="Please enter your password"
                                       required=""
                                       value="" name="confirm_password" id="confirm_password" data-match="#password"
                                       data-match-error="Whoops, these don't match" class="form-control"/>

                                <div class="help-block with-errors"></div>
                            </div>


                            <div class="row">
                                <div class="form-group col-lg-12">
                                    <div class="form-group">
                                        <button type="button" id="register_btn"
                                                class="btn btn-primary2 btn-outline col-xs-12">
                                            Change Password
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
</div>
</div>
</div>


</div>


<!-- Vendor scripts -->
<!-- Vendor scripts -->
<script src="{% static 'vendor/jquery/dist/jquery.min.js' %}"></script>
<script src="{% static 'vendor/jquery-ui/jquery-ui.min.js' %}"></script>
<script src="{% static 'vendor/slimScroll/jquery.slimscroll.min.js' %}"></script>
<script src="{% static 'vendor/bootstrap/dist/js/bootstrap.min.js' %}"></script>
<script src="{% static 'vendor/metisMenu/dist/metisMenu.min.js' %}"></script>
<script src="{% static 'vendor/iCheck/icheck.min.js' %}"></script>
<script src="{% static 'vendor/sparkline/index.js' %}"></script>
<script src="{% static 'vendor/datatables/media/js/jquery.dataTables.js' %}"></script>
<script src="{% static 'vendor/datatables_plugins/integration/bootstrap/3/dataTables.bootstrap.min.js' %}"></script>

<!-- App scripts -->
<script src="{% static 'scripts/homer.js' %}"></script>
<script src="{% static 'vendor/select2-3.5.2/select2.min.js' %}"></script>
<script src="{% static 'vendor/bootstrap-datepicker-master/dist/js/bootstrap-datepicker.min.js' %}"></script>


<!-- App scripts -->
<script src="scripts/homer.js">

</script>

<script>

    $(function () {
        $(".js-source-states").select2();
        $("#pwd_policy").hide();
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            $('a[data-toggle="tab"]').removeClass('btn-primary');
            $('a[data-toggle="tab"]').addClass('btn-default');
            $(this).removeClass('btn-default');
            $(this).addClass('btn-primary');
        })

        $('.next').click(function () {
            var nextId = $(this).parents('.tab-pane').next().attr("id");
            $('[href=#' + nextId + ']').tab('show');
        })

        $('.prev').click(function () {
            var prevId = $(this).parents('.tab-pane').prev().attr("id");
            $('[href=#' + prevId + ']').tab('show');
        })

        $('.submitWizard').click(function () {

            var approve = $(".approveCheck").is(':checked');
            if (approve) {
                // Got to step 1
                $('[href=#step1]').tab('show');

                // Serialize data to post method
                var datastring = $("#simpleForm").serialize();

                // Show notification
                swal({
                    title: "Thank you!",
                    text: "You approved our example form!",
                    type: "success"
                });
            } else {
                // Show notification
                swal({
                    title: "Error!",
                    text: "You have to approve form checkbox.",
                    type: "error"
                });
            }
        })
    });

    $("#register_btn").click(function () {


        var password_rex = /(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*\W)^.{7,17}$/
        var email_pattern = /[^@]+@[^@]+\.[a-zA-Z]{2,6}/
        var valid_no = true;

        if ($('#old_password').val() === "" || $('#old_password').val() == null) {
            $('#lbl_old_password').css("color", "red");
        } else {
            $('#lbl_old_password').css("color", "white");
        }

        if ($('#password').val() === "" || $('#password').val() == null) {
            $('#lbl_password').css("color", "red");
        } else {
            $('#lbl_password').css("color", "white");
            if (!password_rex.test($('#password').val())) {
                $("#pwd_policy").show();
                return false;
            }
            else
                $("#pwd_policy").hide();
        }

        if ($('#confirm_password').val() != $('#password').val()) {
            $('#lbl_confirm_password').css("color", "red");
            $('#lbl_confirm_password').html("&nbsp; &nbsp; Passwords Don't Match");
            return false;
        } else {
            $('#lbl_confirm_password').css("color", "white");
            $('#lbl_confirm_password').text("");
        }

        if ($('#selectuserrole').val() === "" || $('#selectuserrole').val() === null)
            $('#selectuserrole').css("color", "red");
        else
            $('#selectuserrole').css("color", "white");

        if ($('#old_password').val() === "" || $('#old_password').val() == null||$('#password').val() === "" || $('#password').val() == null) {
            return false;
        }
        $.ajax({
            type: "POST",
            url: '/change-password/',
            data: $('#change_pwd_form').serialize(),
            success: function (response) {
                if(response.success == 'true'){
                    $('#lbl_error_msg').text('');
                    $('#lbl_success_msg').text(response.error_msg);
                    setTimeout(function(){ window.location ='/signing-out/' }, 2000);
                }
                else{
                    $('#lbl_error_msg').text(response.error_msg);
                }
            },
            error: function (response) {
                $('#lbl_error_msg').text(response.error_msg);
            },

        });

    });



</script>

</body>
</html>